%%%-------------------------------------------------------------------
%%% @author Fred Youhanaie <fyrlang@anydata.co.uk>
%%% @copyright 2023, Fred Youhanaie
%%% @doc
%%%
%%% Dumps the contents of a baseline data file generated by
%%% `rebar3_bench'.
%%%
%%% @end
%%% Created : 01 Sep 2023 by Fred Youhanaie <fyrlang@anydata.co.uk>
%%%-------------------------------------------------------------------
-module(r3bench_dump).

%% API exports
-export([main/1]).

%%====================================================================
%% API functions
%%====================================================================

%% escript Entry point
main(Args) ->
    io:format("Args: <FILE>~p~n", [Args]),

    [Datafile|_] = Args,
    dump_baseline(Datafile),

    erlang:halt(0).

%%====================================================================
%% Internal functions
%%====================================================================

dump_baseline(Filename) ->
    {ok, Data} = file:read_file(Filename),
    {Version, Samples} = erlang:binary_to_term(Data),
    io:format("version=~p.~n", [Version]),
    [ io:format("Mod=~p, Fun=~p, Data=~p.~n", [M, F, D]) || {M, F, D} <- Samples ],
    ok.

%%====================================================================
